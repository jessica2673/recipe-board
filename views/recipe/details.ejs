<!DOCTYPE html>
<html lang="en">
<%- include('../partials/header.ejs') %>
<body>
    <%- include("../partials/nav.ejs") %>
    <h1>Recipe Details</h1>
    <h2><%= recipe.recipe %></h2>
    <p><%= recipe.author %></p>
    <p><%= recipe.time %></p>
    <p><%= recipe.description %></p>
    <p><%= recipe.ingredients %></p>
    <%- include('../partials/footer.ejs') %>
    <a class="delete" data-doc="<%= recipe._id %>">Delete Recipe</a>

    <script>
        const deleteRecipe = document.querySelector('a.delete');

        deleteRecipe.addEventListener('click', e => {
            const endpoint = `/recipes/${deleteRecipe.dataset.doc}`;

            fetch(deleteRecipe, {
                method: 'DELETE'
            })
                .then((jsonResponse) => {
                    jsonResponse.json()
                        .then((parsedData) => {
                            window.location.href = parsedData.redirect;
                        })
                })
                .catch(err => {
                    console.log(err);
                })
        })
    </script>
</body>
</html>